Y=[0.5 0.5;0.5 0.5;1 0;0.5 0.5;0.5 0.5;0.5 0.5;0.5 0.5;0 1];

G=[0 0 1 1 0 0 1 0;
   0 0 0 1 1 1 1 1;
   1 0 0 0 0 0 1 0;
   1 1 0 0 0 0 1 0;
   0 1 0 0 0 0 1 1;
   0 1 0 0 0 0 1 1;
   1 1 1 1 1 1 0 0;
   0 1 0 0 1 1 0 0];

T=[0 0 1 1 1 1 1 1;
   0 0 1 1 1 1 1 1;
   1 1 0 0 0 0 1 1;
   1 1 0 0 0 0 1 1;
   1 1 0 0 0 0 1 1;
   1 1 0 0 0 0 1 1;
   1 1 1 1 1 1 0 0;
   1 1 1 1 1 1 0 0];

Y0=Y
I=[1 0;
   0 1];

for i=1:8
	for u=1:8
        A=0;
		for(v=1:8)
			if(T(u,v)==1)
				A=A+Y(v,:)*Y(v,:)';
			end
		end
		temp=zeros(1,2);
		for(v=1:8)
			if(G(u,v)==1)
				temp=temp+Y(v,:);
			end
		end
		
		
		if(u==3||u==8)
			A=A+1;
			temp=temp+Y0(u,:);
        	end
	        A=(1.0)/A;

		Y(u,:)=(A*I)*temp';
		Y(u,:)=1/sum(Y(u,:)).*Y(u,:);
	end
	Y
end